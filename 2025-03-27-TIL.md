# GIT TIL 92 - NIMA 모델 파인튜닝 경험

<br><br>

## 1. NIMA 모델의 한계 발견

### 1-1. 초기 테스트 결과
- 3,000장의 이미지로 테스트 진행
- 대부분의 이미지가 5점대에 편향되는 현상 발견
- 이미지의 품질을 명확하게 구분하지 못하는 문제 발생

### 1-2. 문제점 분석
- **점수 편향**: 대부분의 이미지가 중간 점수(5점대)에 집중
- **구분력 부족**: 좋은 이미지와 나쁜 이미지를 명확하게 구분하지 못함
- **실용성 저하**: 실제 이미지 품질 평가에 활용하기 어려움

<br>

## 2. 파인튜닝 결정 배경

### 2-1. 수동 평가 데이터 구축
- 3,000장의 이미지를 직접 수동으로 평가
- 1.0 ~ 10.0 사이의 점수 체계 적용
- 평가 기준 수립 및 일관성 유지

### 2-2. 파인튜닝의 필요성
- **모델 개선 필요**: 기존 NIMA 모델의 한계 극복
- **데이터 활용**: 수집한 수동 평가 데이터의 가치 활용
- **실용성 향상**: 실제 이미지 품질 평가에 활용 가능한 모델 개발

<br>

## 3. 파인튜닝 과정

### 3-1. 데이터 준비
- **이미지 전처리**
  - 크기 조정 (224x224)
  - 정규화
  - 데이터 증강

- **레이블 처리**
  - 수동 평가 점수 정규화
  - 데이터 분포 분석
  - 균형 잡힌 데이터셋 구성

### 3-2. 모델 수정
- **기본 구조**
  - ResNet18 기반
  - NIMA 구조 활용
  - 회귀 헤드 추가

- **학습 파라미터**
  - 학습률 조정
  - 배치 크기 설정
  - 에포크 수 결정

### 3-3. 학습 과정
- **검증**
  - 정기적인 성능 평가
  - 과적합 모니터링
  - 점수 분포 확인

- **개선**
  - 모델 구조 조정
  - 하이퍼파라미터 튜닝
  - 데이터 품질 향상

<br>

## 4. 결과 및 교훈

### 4-1. 개선된 점
- **점수 분포 개선**: 5점대 편향 현상 해소
- **구분력 향상**: 좋은/나쁜 이미지 구분 가능
- **실용성 증가**: 실제 이미지 품질 평가에 활용 가능

### 4-2. 얻은 인사이트
- **데이터의 중요성**: 수동 평가 데이터의 품질이 모델 성능에 결정적
- **평가 기준의 명확성**: 일관된 평가 기준 수립의 중요성
- **지속적 개선**: 모니터링과 개선의 필요성

<br>

## 5. 향후 발전 방향

### 5-1. 추가 개선 사항
- **데이터셋 확장**: 더 다양한 이미지 추가
- **평가 기준 세분화**: 더 세밀한 평가 기준 도입
- **모델 구조 개선**: 더 효율적인 아키텍처 탐색

### 5-2. 활용 방안
- **자동화 시스템**: 이미지 품질 자동 평가 시스템 구축
- **품질 관리**: 이미지 품질 관리 프로세스에 통합
- **사용자 피드백**: 실제 사용자 피드백 반영

<br><br>

---

<br><br>

