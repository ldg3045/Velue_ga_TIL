# GIT TIL 52 - Django JSON Response & Serialization

<br>

## 1. JsonResponseë€?

- Djangoì—ì„œ JSON í˜•ì‹ì˜ ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ” í´ë˜ìŠ¤
- HttpResponseì˜ ì„œë¸Œí´ë˜ìŠ¤
- Content-Typeì„ 'application/json'ìœ¼ë¡œ ìë™ ì„¤ì •

### 1-1. ê¸°ë³¸ ì‚¬ìš©ë²•
```python
from django.http import JsonResponse

def article_json(request):
    data = {
        'title': 'ì²« ë²ˆì§¸ ê¸€',
        'content': 'ë‚´ìš©ì…ë‹ˆë‹¤.',
        'created_at': '2024-02-11'
    }
    return JsonResponse(data)
```

<br>

## 2. Serialization (ì§ë ¬í™”)

- ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ì „ì†¡ ê°€ëŠ¥í•œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
- Django ëª¨ë¸ ê°ì²´ â†’ JSON, XML ë“±ìœ¼ë¡œ ë³€í™˜
- QuerySetê³¼ ê°™ì€ ë³µì¡í•œ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•  ë•Œ í•„ìš”

### 2-1. Django Serializer ì‚¬ìš©
```python
from django.core import serializers
from .models import Article

def article_list_json(request):
    articles = Article.objects.all()
    data = serializers.serialize('json', articles)
    return JsonResponse(data, safe=False)
```

<br>

## 3. Seed ë°ì´í„°ë¡œ ì‹¤ìŠµí•˜ê¸°

### 3-1. django-seed ì„¤ì¹˜
```bash
pip install django-seed

# settings.pyì— ì¶”ê°€
INSTALLED_APPS = [
    ...
    'django_seed',
]
```

### 3-2. ë”ë¯¸ ë°ì´í„° ìƒì„±
```bash
# 10ê°œì˜ Article ë”ë¯¸ ë°ì´í„° ìƒì„±
python manage.py seed articles --number=10
```

### 3-3. JSON ì‘ë‹µ ì‹¤ìŠµ
```python
# views.py
from django.http import JsonResponse
from django.core import serializers
from .models import Article

def article_json_1(request):
    # ë‹¨ì¼ ê²Œì‹œê¸€ JSON ì‘ë‹µ
    article = Article.objects.get(pk=1)
    data = {
        'title': article.title,
        'content': article.content,
        'created_at': article.created_at,
    }
    return JsonResponse(data)

def article_json_2(request):
    # ì „ì²´ ê²Œì‹œê¸€ JSON ì‘ë‹µ
    articles = Article.objects.all()
    data = serializers.serialize('json', articles)
    return JsonResponse(data, safe=False)

def article_json_3(request):
    # í•„í„°ë§ëœ ë°ì´í„° JSON ì‘ë‹µ
    articles = Article.objects.filter(title__contains='hello')
    article_list = []
    
    for article in articles:
        article_dict = {
            'id': article.pk,
            'title': article.title,
            'content': article.content,
            'created_at': article.created_at.strftime('%Y-%m-%d')
        }
        article_list.append(article_dict)
    
    return JsonResponse(article_list, safe=False)
```

### 3-4. URL ì„¤ì •
```python
# urls.py
urlpatterns = [
    path('json1/', views.article_json_1),
    path('json2/', views.article_json_2),
    path('json3/', views.article_json_3),
]
```

<br>

## 4. JSON ì‘ë‹µ ì˜ˆì‹œ

### 4-1. ë‹¨ì¼ ê°ì²´ ì‘ë‹µ
```json
{
    "title": "Hello Django",
    "content": "This is a test article",
    "created_at": "2024-02-11T12:00:00Z"
}
```

### 4-2. ì „ì²´ ê°ì²´ ë¦¬ìŠ¤íŠ¸ ì‘ë‹µ
```json
[
    {
        "model": "articles.article",
        "pk": 1,
        "fields": {
            "title": "First Article",
            "content": "Content here",
            "created_at": "2024-02-11T12:00:00Z"
        }
    },
    {
        "model": "articles.article",
        "pk": 2,
        "fields": {
            "title": "Second Article",
            "content": "More content",
            "created_at": "2024-02-11T12:30:00Z"
        }
    }
]
```

<br>

## ğŸ’¡ ì£¼ì˜ì‚¬í•­

1. safe ë§¤ê°œë³€ìˆ˜
   - ê¸°ë³¸ê°’ì€ True
   - ë”•ì…”ë„ˆë¦¬ê°€ ì•„ë‹Œ ê°ì²´ ì§ë ¬í™” ì‹œ Falseë¡œ ì„¤ì • í•„ìš”

2. ë‚ ì§œ/ì‹œê°„ ì²˜ë¦¬
   - datetime ê°ì²´ëŠ” ìë™ìœ¼ë¡œ ì§ë ¬í™”ë˜ì§€ ì•ŠìŒ
   - strftime() ë“±ì„ ì‚¬ìš©í•˜ì—¬ ë¬¸ìì—´ë¡œ ë³€í™˜ í•„ìš”

3. ì¤‘ì²© ê°ì²´ ì²˜ë¦¬
   - ë³µì¡í•œ ê´€ê³„ë¥¼ ê°€ì§„ ê°ì²´ëŠ” ì§ì ‘ ì§ë ¬í™” ë¡œì§ êµ¬í˜„ í•„ìš”
   - DRF(Django REST Framework) ì‚¬ìš© ê³ ë ¤

4. ì„±ëŠ¥ ê³ ë ¤
   - ëŒ€ëŸ‰ì˜ ë°ì´í„° ì§ë ¬í™” ì‹œ ì„±ëŠ¥ ì˜í–¥
   - í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒì ìœ¼ë¡œ ì§ë ¬í™”

<br>

---