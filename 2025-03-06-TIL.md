

---



---


---


## SQLite ìœ ì§€í•˜ë©´ì„œ ì„ì‹œ í•´ê²°
- wsgi.py
![Image](https://github.com/user-attachments/assets/031569ee-03a8-4d45-9b43-84fe643d39b7)



- settings.py
![Image](https://github.com/user-attachments/assets/25216c89-9aa9-4da9-8ff8-9e4ca708f5dd)
![Image](https://github.com/user-attachments/assets/3403d2fa-9a8e-47d5-9582-5de59631a8b7)


### ì´ ë°©ì‹ ë˜í•œ ë°°í¬ ì„œë²„ê°€ í‘¸ì‰¬ëœ ì½”ë“œë¡œ ìˆ˜ì • ë˜ë©´ì„œ 
### ì„œë²„ê°€ ì¬ì‹œì‘ë˜ê¸° ë•Œë¬¸ì— DB ì´ˆê¸°í™” ë  ê±°ë¼ ì˜ˆìƒ ë  ê²ƒ ê°™ì•„ìš”.. ğŸ˜¥

---

### ê·¸ëŸ°ë° ì™œ ë˜ëŠ” ê±°ì„??

![Image](https://github.com/user-attachments/assets/5a7d3f1c-5f79-4c10-98ef-e8c637d77138)

ë§ˆì´ ì—ì…‹ì—ë„ ìƒì„± ì˜ ë©ë‹ˆë‹¤.

ì´ìœ ê°€ ë­”ê°€ìš”..?













---

# GIT TIL 71 - CSRF ì´ìŠˆì™€ SQLite DB ì´ˆê¸°í™” ë¬¸ì œ í•´ê²°

<br><br>

<img width="1389" alt="Image" src="https://github.com/user-attachments/assets/fe11325f-b8dc-4708-aa30-f94e907eb96e" />

##  ë°œìƒí•œ ë¬¸ì œ

### 1. CSRF ì´ìŠˆ

![Image](https://github.com/user-attachments/assets/4d604d7d-9f32-409c-b1d4-288851b15525)

**CSRF_TRUSTED_ORIGINS - Azure ë„ë©”ì¸ ì¶”ê°€**
- Djangoì˜ ë³´ì•ˆ ì„¤ì •ì—ì„œ Azure ì›¹ì‚¬ì´íŠ¸ì˜ ë„ë©”ì¸ì´ í—ˆìš©ëœ ì¶œì²˜(trusted origins)ì— ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
- ì´ëŠ” CSRF ë³´ì•ˆì„ ìœ„í•œ ê²ƒìœ¼ë¡œ, í—ˆê°€ë˜ì§€ ì•Šì€ ë„ë©”ì¸ì—ì„œì˜ ìš”ì²­ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤.
- ì¶”ê°€ë¡œ CSRF_COOKIE_DOMAINë„ ì„¤ì •
- STATIC_ROOT ì„¤ì • ë˜í•œ ì—†ì–´ì„œ ë°œìƒí•œ ì˜¤ë¥˜ë„ ì•„ë˜ì™€ ê°™ì´ ê²½ë¡œ ì¶”ê°€
![Image](https://github.com/user-attachments/assets/406c256f-ed55-4d6d-b33a-57f25c765106)

<br><br>

---

<br><br>

### 2. SQLite DB ì´ˆê¸°í™” ë¬¸ì œ

>**CSRFëŠ” í•´ê²° ëœ ê²ƒìœ¼ë¡œ ë³´ì´ë‚˜, íšŒì› ê°€ì…ê³¼ ë¡œê·¸ì¸ì´ ì•ˆë¨**
- íšŒì›ê°€ì… ì™„ë£Œë¥¼ ëˆ„ë¥´ë©´ users_user í…Œì´ë¸”ì´ ì—†ë‹¤ê³  ëœ¸
- ë¡œê·¸ì¸ ë²„íŠ¼ ë˜í•œ ëˆ„ë¥´ë©´ users_user í…Œì´ë¸”ì´ ì—†ë‹¤ê³  ëœ¸


![Image](https://github.com/user-attachments/assets/a26f274f-1bb8-491f-848d-9cf57e9c9951)

![Image](https://github.com/user-attachments/assets/249b2d45-3ffd-495e-8424-abaddbdfbca1)




í˜„ì¬ ìƒí™©ìœ¼ë¡œ ë³´ì•„, SQLite DBë¥¼ ì‚¬ìš© ì¤‘ì— ìƒê¸´ ì˜¤ë¥˜ë¡œ ë³´ì…ë‹ˆë‹¤.
- Azure App Serviceì—ì„œëŠ” SQLite DBê°€ íœ˜ë°œì„± (ì„œë²„ ì¬ì‹œì‘ì‹œ ì´ˆê¸°í™” ë¨)

> ë¡œì»¬ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í•˜ê³  í‘¸ì‹œí•´ë„, Azureì—ì„œ ì„œë²„ê°€ ì¬ì‹œì‘ë˜ë©´ <br>
> DB íŒŒì¼ì´ ì´ˆê¸°í™”ë˜ì–´ DB í…Œì´ë¸”ì´(users_user ë˜í•œ) ì‚¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.

ì´ëŠ” Azureì˜ ê³µì‹ ë¬¸ì„œì—ì„œë„ ì–¸ê¸‰ë˜ì–´ ìˆëŠ” ë‚´ìš©ì´ë©°, <br>
ê·¸ë˜ì„œ Azure App Serviceì—ì„œëŠ” PostgreSQL, MySQL ë“±ì˜ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

<br>

### í•´ê²° ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€ì…ë‹ˆë‹¤.

<br>

### 1. PostgreSQLë¡œ ì „í™˜ (ê¶Œì¥)
- Azure Database for PostgreSQL ì„œë¹„ìŠ¤ ì‚¬ìš©
- requirements.txtì— psycopg2-binary ì¶”ê°€
- settings.pyì˜ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ë³€ê²½

### 2. SQLite ìœ ì§€í•˜ë©´ì„œ ì„ì‹œ í•´ê²° (ë¹„ê¶Œì¥)
- ë©”ëª¨ë¦¬ DB ì‚¬ìš©
- ë§¤ ì‹œì‘ì‹œ ìë™ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰í•˜ë„ë¡ ì„¤ì •

> ### ì¼ë‹¨ `2ë²ˆ` ë°©ë²•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•´ë³´ê² ìŠµë‹ˆë‹¤.

<br>


## 3. SQLite ìœ ì§€í•˜ë©´ì„œ ì„ì‹œ í•´ê²°
- wsgi.py
![Image](https://github.com/user-attachments/assets/031569ee-03a8-4d45-9b43-84fe643d39b7)



- settings.py
![Image](https://github.com/user-attachments/assets/25216c89-9aa9-4da9-8ff8-9e4ca708f5dd)
![Image](https://github.com/user-attachments/assets/3403d2fa-9a8e-47d5-9582-5de59631a8b7)


<details>
<summary>ì½”ë“œìŠ¤ë‹ˆí«</summary>

## SQLite ìœ ì§€í•˜ë©´ì„œ ì„ì‹œ í•´ê²° (êµ¬í˜„ëœ ë°©ì‹)

```python
# wsgi.py
import os
from django.core.wsgi import get_wsgi_application
from django.core.management import execute_from_command_line

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
application = get_wsgi_application()

# ì„œë²„ ì‹œì‘ì‹œ ìë™ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
execute_from_command_line(['manage.py', 'migrate'])
```

```python
# settings.py
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}
```


</details>
<br>

ê·¼ë° ì•„ë§ˆ ì´ ë°©ì‹ë„ ë°°í¬ ì„œë²„ê°€ í‘¸ì‰¬ëœ ì½”ë“œë¡œ ìˆ˜ì • ë˜ë©´ì„œ <br>
ì„œë²„ê°€ ì¬ì‹œì‘ë˜ê¸° ë•Œë¬¸ì— DB ì´ˆê¸°í™” ë  ê±°ë¼ ì˜ˆìƒ ë  ê²ƒ ê°™ì€ë°.. ğŸ˜¥


<br><br>


## ì•„ë‹ˆ ì™œ ë˜ëŠ” ê±°ì§€..?

### 3-1. ì˜ˆìƒê³¼ ë‹¤ë¥¸ ê²°ê³¼
- ì´ˆê¸° ì˜ˆìƒ: ì„œë²„ ì¬ì‹œì‘ ì‹œ DBê°€ ì´ˆê¸°í™”ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒ
- ì‹¤ì œ ê²°ê³¼: DBê°€ ì •ìƒì ìœ¼ë¡œ ìœ ì§€ë˜ë©° ì‘ë™

### 3-2. ì •ìƒ ì‘ë™ì˜ ì´ìœ  ë¶„ì„
1. **Azure App Serviceì˜ íŒŒì¼ ì‹œìŠ¤í…œ íŠ¹ì„±**
   - App ServiceëŠ” ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ë¥¼ ì œê³µ
   - `/home` ë””ë ‰í† ë¦¬ëŠ” ì„œë²„ ì¬ì‹œì‘ í›„ì—ë„ ìœ ì§€ë¨

2. **Djangoì˜ DB íŒŒì¼ ìœ„ì¹˜**
   - SQLite DB íŒŒì¼ì´ ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ ì˜ì—­ì— ì €ì¥ë¨
   - ì„œë²„ ì¬ì‹œì‘í•´ë„ ë°ì´í„° ë³´ì¡´

3. **ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ íš¨ê³¼**
   - wsgi.pyì— ì¶”ê°€í•œ ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ì½”ë“œ
   - ì„œë²„ ì‹œì‘ ì‹œ í•„ìš”í•œ í…Œì´ë¸” ìë™ ìƒì„±
   - ê¸°ì¡´ ë°ì´í„°ëŠ” ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ì— ë³´ì¡´

<br><br>

---

<br><br>